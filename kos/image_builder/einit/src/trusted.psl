use nk.base._

/* Declaration of entities. */
use EDL kl.core.Core
use EDL Einit
use EDL kl.TlsEntity
use EDL kl.core.NameServer

/**
 * This instruction enables to start up system entities by KOS kernel.
 */
execute src=kl.core.Core, dst=kl.core.Core
{
    grant()
}

execute src=kl.core.Core, dst=Einit
{
    grant()
}

/**
 * This code enables to send requests from Einit entity to KOS kernel and get
 * responses. It makes able to use system calls by Einit.
 */
request src=Einit, dst=kl.core.Core
{
    grant()
}

response src=kl.core.Core, dst=Einit
{
    grant()
}

request src=kl.TlsEntity, dst=kl.core.Core
{
    grant()
}

response src=kl.core.Core, dst=kl.TlsEntity
{
    grant()
}

request src=Einit, dst=kl.TlsEntity
{
    grant()
}

execute src=Einit, dst=kl.TlsEntity
{
    grant()
}

request src=Einit, dst=kl.TlsEntity
{
    grant()
}

response src=kl.TlsEntity, dst=Einit
{
    grant()
}

security src=kl.core.NameServer
{
    grant()
}

request src=kl.core.NameServer, dst=kl.core.Core
{
    grant()
}

response src=kl.core.Core, dst=kl.core.NameServer
{
    grant()
}

request dst=kl.core.NameServer
{
    grant()
}

response src=kl.core.NameServer
{
    grant()
}
